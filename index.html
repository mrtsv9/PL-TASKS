<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <!-- <script src="js/myScript.js"></script> -->
</head>

<body>

    <div class="form">
        <select id="products">
            <option id="seledka1" value="100">Селедка над шубой</option>
            <option id="seledka2" value="200">Селедка под шубой</option>
            <option id="seledka3" value="300">Селедка возле шубы</option>
            <option id="seledka4" value="400">Селедка между шубой</option>
        </select>
        <input id="amount" type="number" value="10" placeholder="Количество продуктов">
        <button id="add" onclick="onadd()">Добавить</button>

        <hr>

        <table style="text-align: center; border: 1px solid black;">
            <thead>
                <tr>
                    <th>Наименование блюда</th>
                    <th>Количество</th>
                    <th>Калорийность</th>
                    <th>Общая Калорийность</th>
                </tr>
            </thead>
            <tbody id="rows"></tbody>

        </table>

        <hr>

        <div>
            <button id="cnt" onclick="count()">Расчитать результат</button>
            <button id="clr" onclick="clear()">Очистить</button>
        </div>
        <hr>
        <b>
            <span>Суммарная калорийность:</span>
            <span id="totalResult">0</span>
        </b>




        <script>

            function onadd() {
                var n = document.getElementById("products").options.selectedIndex;
                var name = document.getElementById("products").options[n].text;
                var calories = document.getElementById("products").options[n].value;
                var amount = document.getElementById("amount").value;
                find(name, calories, amount);
            }

            function find(name, calories, amount) {
                let tempCalories = parseInt(calories);
                let tempAmount = parseInt(amount);

                var table = document.getElementsByClassName(name);
                var Row = document.getElementById(name);
                if (Row != null) {
                    var count = Row.getElementsByClassName('amount');
                    var total = Row.getElementsByClassName("total");
                    let param = parseInt(count[0].innerText);
                    if (tempAmount > 0) {
                        total[0].innerText = (param + tempCalories) * tempAmount;
                        count[0].innerText = param + amount;
                    }
                }
                else {
                    let length = table.length;
                    if (length == 0) {
                        if (amount > 0) {
                            addRow(name, amount, calories);
                        }
                    }
                }

            }

            function addRow(name, calories, amount) {
                var table = document.getElementById('rows');

                if (name != null) {
                    var tr = document.createElement("tr");
                    tr.id = name;

                    tr.innerHTML = '<th class="name">' + name + '</th> <th class="calories">' + calories
                        + '</th> <th class="amount">'
                        + amount + '</th> <th class="total">'
                        + calories * amount + '</th>';

                    table.appendChild(tr);
                }
            }


            function count() {
                var table = document.getElementById("rows").getElementsByTagName("tr");
                let result = 0;
                let length = table.length;
                for (let i = 0; i < length; i++) {
                    let res = parseInt(table[i].getElementsByClassName("total")[0].innerText);
                    result += res;
                }
                document.getElementById("totalResult").innerText = result;
            }

            function clear() {
                var table = document.getElementById("rows");
                var rowCount = table.rows.length;
                for (var x = rowCount; x > 0; x--) {
                    myTable.deleteRow(x);
                }
                // while (table.rows.length > 0) {
                //     table.deleteRow(0);
                // }
                document.getElementById("totalResult").innerText = 0;
            }

        </script>

        <!-- <script src="js/myScript.js"></script> -->

</body>

</html>